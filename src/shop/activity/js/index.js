"use strict";!function(){var r,e,o="https://act.zhaoliangji.com",a="https://product.zhaoliangji.com",n=!1,d={propKeyword:{}},l={};new Vue({el:"#app",data:{screenHeight:0,isShowPage:!1,floatData:[],floatTime:"",floatStatus:!1,floatIndex:0,total:0,countTimedate:{d:0,h:0,m:0,s:0,ms:9},deadline:!1,isShowConpon:!1,isReceiveRedStatus:!1,fqlData:"",listQuery:{page:1,prop_str:"",price_sort:0,price_range:"",only_onsale:0,tag_id:0},detailData:"",searchBox:!1,isLoad:!1,productData:[],sortData:{},sortItem:{index:0,name:"全部"},isFull:!1,tabHeight:0,isFixed:!1,isHideTop:!0,activityId:"",sk:"",gid:"",price:"",priceTemp:"",priceList:[],priceListStatus:{},priceSelectVal:"",priceSelectIndex:"",firstPrice:"",lastPrice:"",selectData:{},shaixuanLabel:{},shaixuanLabelLength:0,totalNum:0,selectedLabel:{},selectedLabelTemp:{},selectedLabelLength:0,propKey:{8:"network",9:"version",10:"color",11:"memrory",12:"percentage",14:"ppi",16:"SIM",23:"system_version"}},watch:{firstPrice:function(){this.priceSelectIndex="",this.bindPrice()},lastPrice:function(){this.priceSelectIndex="",this.bindPrice()}},created:function(){var t=this;this.activityId=this.getQueryString("activity_id"),this.sk=this.getQueryString("sk"),this.gid=this.getQueryString("gid"),this.getPriceList(),this.getSelectData(),this.isAPP()?this.appMethods():this.getDetailData(),zlj.on("onPageShow",function(){t.enterEvent()}),this.screenHeight=window.screen.height},mounted:function(){clearTimeout(r),clearTimeout(e),this.tabControlHandle(),this.getProductData(),zlj.switchRefresh(!1)},methods:{enterEvent:function(){"miniprogram"===window.__wxjs_environment?this.eventPoint("enter_h5_act_page",{page_id:10049,activity_id:this.activityId,activity_name:document.title,channel_id:2}):(this.shencePoint("enter_activity_page",{activity_id:this.activityId,activity_name:document.title,event_type:"pageview"}),this.eventPoint("enter_h5_act_page",{page_id:10049,activity_id:this.activityId,activity_name:document.title,channel_id:1}))},getTabHeight:function(){var t=document.getElementById("tab-box");this.tabHeight=t.offsetHeight},appMethods:function(){var e=this;window.goLoginMsg=function(t){window.userData="string"==typeof t?JSON.parse(t):t,e.getDetailData()},window.goLoginOutMsg=function(t){e.getDetailData()},window.onPageShow=function(){}},isAPP:function(){var t=!1;return window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.goLogin?t=!0:window.control&&window.control.goLogin&&(t=!0),t},getFloatData:function(){var o=this,t={};o.floatTime&&(t.current_time=o.floatTime),axios.get("https://panda.huodao.hk/api/account/shaidan/get_float_data",{params:t}).then(function(t){var e=t.data;if(1==e.code){if(0==e.data.length)return;o.floatStatus=!0,o.floatData=e.data[o.floatIndex];var i=setInterval(function(){o.floatIndex++,o.floatIndex<=e.data.length?(o.floatData=e.data[o.floatIndex],o.floatStatus=!0,setTimeout(function(){o.floatStatus=!1},1500)):(o.floatIndex=0,o.floatTime=e.data[o.floatIndex].buy_time,o.getFloatData(),clearInterval(i))},6e4);setTimeout(function(){o.floatStatus=!1},1500)}})},getDetailData:function(){var i=this;axios.get(o+"/api/theme/activity_detail?activity_id="+i.activityId).then(function(t){var e=t.data;"1"===e.code&&(i.detailData=e.data,i.countTime(i.detailData.end_time),i.countTimeMs(),document.title=e.data.activity_title,zlj.changeTitle(e.data.activity_title),i.detailData.coupon_info&&(window.userData?i.isReceiveConpon(i.detailData.coupon_info.bonus_code):(i.isShowConpon=!0,i.isReceiveRedStatus=!1)),i.getFloatData(),i.enterEvent(),1==i.detailData.show_fenqi&&i.getFQLData(),i.$nextTick(function(){i.isShowPage=!0}))})},isReceiveConpon:function(t){var i=this,e={};e.token=window.userData.token,e.bonus_code=t,axios.post(o+"/api/bonus/check_user_bonus_status",e).then(function(t){var e=t.data;"1"===e.code&&(1==e.data.status?i.isReceiveRedStatus=!0:i.isReceiveRedStatus=!1),i.isShowConpon=!0})},receiveCoupon:function(){var i=this;if(!i.isReceiveRedStatus)if(window.userData&&window.userData.token){var t={};t.token=window.userData.token,t.bonus_code=i.detailData.coupon_info.bonus_code,t.activity_id=i.activityId,axios.post(o+"/api/bonus/draw_bonus",t).then(function(t){var e=t.data;"1"===e.code?(Modal({title:"提示",content:e.msg,cancelButton:!1,confirmText:"知道了"}),i.isReceiveRedStatus=!0,i.eventPoint("get_coupon",{page_id:10049,activity_id:i.activityId,activity_name:document.title,coupon_id:i.detailData.coupon_info.bonus_id,coupon_name:i.detailData.coupon_info.bonus_name,coupon_cost:i.detailData.coupon_info.bonus_amount,event_type:"click"})):-5==e.code?(Modal({title:"提示",content:e.msg,cancelButton:!1,confirmText:"知道了"}),i.isReceiveRedStatus=!1):Modal({title:"提示",content:e.msg,cancelButton:!1,confirmText:"知道了"})})}else window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.goLogin?window.webkit.messageHandlers.goLogin.postMessage({}):window.control&&window.control.goLogin?window.control.goLogin():Modal({title:"提示",content:"请下载找靓机App",cancelButton:!1,confirmText:"知道了"})},getFQLData:function(){var i=this;axios.get(o+"/api/fenqi/get_fenqile_quota").then(function(t){var e=t.data;"1"===e.code&&(i.fqlData=e.data)})},getFQLAttach:function(){window.userData&&window.userData.token?window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.getFQLQuota?this.gotoFql():window.control&&window.control.getFQLQuota?this.gotoFql():Modal({title:"提示",content:"请下载找靓机app",cancelButton:!1,confirmText:"知道了"}):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.goLogin?window.webkit.messageHandlers.goLogin.postMessage({}):window.control&&window.control.goLogin?window.control.goLogin():Modal({title:"提示",content:"请下载找靓机app",cancelButton:!1,confirmText:"知道了"})},gotoFql:function(){var t={};t.token=window.userData.token,t.phone=window.userData.mobile,t.type=1,axios.get(o+"/api/fenqi/get_fenqile_attach",{params:t}).then(function(t){var e=t.data;if("1"===e.code){var i=e.data,o={agent:"1081565",redirectUri:i&&i.redirect_uri?i.redirect_uri:"",attach:i&&i.attach?JSON.stringify(i.attach):""};window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.getFQLQuota?window.webkit.messageHandlers.getFQLQuota.postMessage(o):window.control&&window.control.getFQLQuota&&window.control.getFQLQuota(JSON.stringify(o))}else Modal({title:"提示",content:e.msg,cancelButton:!1,confirmText:"知道了"})})},countTime:function(t){var e,i,o,a,n=this,c=(new Date).getTime(),s=1e3*t-c;0<=s?(e=Math.floor(s/1e3/60/60/24),i=Math.floor(s/1e3/60/60%24),o=Math.floor(s/1e3/60%60),(a=Math.floor(s/1e3%60))<10&&(a="0"+a),o<10&&(o="0"+o),i<10&&(i="0"+i)):(e="0",a=o=i="00",n.countTimedate.ms="0",n.deadline=!0,clearTimeout(r)),n.countTimedate.d=e,n.countTimedate.h=i,n.countTimedate.m=o,n.countTimedate.s=a,n.deadline||(r=setTimeout(function(){n.countTime(t)},1e3))},countTimeMs:function(){var t=this;t.deadline?clearTimeout(e):(t.countTimedate.ms?t.countTimedate.ms--:t.countTimedate.ms=9,e=setTimeout(t.countTimeMs,100))},changePrice:function(){if(this.listQuery.price_sort?"asc"===this.listQuery.price_sort?this.listQuery.price_sort="desc":"desc"===this.listQuery.price_sort&&(this.listQuery.price_sort=""):this.listQuery.price_sort="asc",this.isFull=!1,this.listQuery.page=1,this.listQuery.price_sort){var t={page_id:10049,operation_module:"价格",filter_content:{},event_type:"click",is_cancel:1};"asc"===this.listQuery.price_sort?t.filter_content.sort="降序":"desc"===this.listQuery.price_sort&&(t.filter_content.sort="升序"),t.filter_content=JSON.stringify(t.filter_content),this.shencePoint("click_filter_goods",t),this.eventPoint("click_filter_goods",t)}this.getProductData()},changeonlyOnsale:function(){this.isFull=!1,this.listQuery.page=1,0==this.listQuery.only_onsale?this.listQuery.only_onsale=1:this.listQuery.only_onsale=0,this.getProductData();var t={page_id:10049,operation_module:"是否在售",filter_content:{},event_type:"click"};0===this.listQuery.only_onsale?(t.filter_content.is_sale="不在售",t.is_cancel=0):1===this.listQuery.only_onsale&&(t.filter_content.is_sale="在售",t.is_cancel=1),t.filter_content=JSON.stringify(t.filter_content),this.shencePoint("click_filter_goods",t),this.eventPoint("click_filter_goods",t)},openSearch:function(){this.searchBox=!this.searchBox,document.body.classList.add("overflow-hidden")},hideSelectBox:function(){this.searchBox=!1,document.body.classList.remove("overflow-hidden"),event.preventDefault(),this.confirmSelect()},stopModal:function(){event.stopPropagation()},getPriceList:function(){var i=this;axios.get(a+"/api/product/filter_price").then(function(t){var e=t.data;"1"===e.code&&(i.priceList=e.data)})},priceSelect:function(t){var e=this,i=t.currentTarget,o=(i.dataset.val,i.dataset.index);if(e.isLoad){o==e.priceSelectIndex?e.priceSelectIndex="":e.priceSelectIndex=o;var a="";e.priceSelectIndex?(a=e.priceList[e.priceSelectIndex-1],e.$set(e.selectedLabelTemp,"price",{price:a})):(delete e.selectedLabelTemp.price,a=""),n=!1,a&&-1==a.indexOf("-")?e.priceTemp=a.split("以")[0]+"-99999":e.priceTemp=a,e.firstPrice="",e.lastPrice=""}},bindPrice:function(){var t=this,e="";if(t.firstPrice||t.lastPrice){if(t.firstPrice&&t.lastPrice){if(!(Number(t.firstPrice)<=Number(t.lastPrice)))return void(n=!0);e=t.firstPrice+"-"+t.lastPrice}t.firstPrice&&!t.lastPrice&&(e=t.firstPrice+"以上"),!t.firstPrice&&t.lastPrice&&(e="0-"+t.lastPrice)}else e="";n=!1,e&&-1==e.indexOf("-")?t.priceTemp=e.split("以")[0]+"-99999":t.priceTemp=e},getSelectData:function(){var i=this,t={};t.type_id=i.detailData.type_id,t.brand_id=i.detailData.brand_id,t.model_id=i.detailData.model_id,axios.get(a+"/api/product/filter_attr",{params:t}).then(function(t){var e=t.data;"1"===e.code&&(i.selectData=e.data.main)})},selectLabel:function(t){var e=this,i=t.currentTarget.dataset.pnid,o=t.currentTarget.dataset.pvid,a=t.currentTarget.dataset.pindex,n=t.currentTarget.dataset.index,c=t.currentTarget.dataset.name;if(e.isLoad)if(e.selectData[a].filter_data[n].isactive){delete d.propKeyword[o];for(var s=l[i],r=0;r<s.length;r++)s[r]==c&&(l[i].splice(r,1),0==l[i].length&&delete l[i]);e.$set(e.selectData[a].filter_data[n],"isactive",!1)}else d.propKeyword[o]=i+":"+o,e.$set(e.selectData[a].filter_data[n],"isactive",!0),l[i]||(l[i]=[]),l[i].push(c)},confirmSelect:function(){var t=this;if(n)Modal({title:"请输入正确的价格区间",content:data.msg,cancelButton:!1,confirmText:"知道了"});else{var e=[];for(var i in d.propKeyword)e.push(d.propKeyword[i]);t.detailData.model_id&&0<e.length&&e.unshift("5:"+t.detailData.model_id),t.searchBox=!1,t.$set(t.listQuery,"prop_str",e.join(";")),t.$set(t.listQuery,"page",1),t.$set(t.listQuery,"price_range",t.priceTemp),t.shaixuanLabelLength=Object.keys(l).length,t.getProductData();var o={page_id:10049,operation_module:"筛选",filter_content:{},event_type:"click"};for(var i in l)this.propKey[i]&&(o.filter_content[this.propKey[i]]=l[i]);o.filter_content.price=t.priceTemp,o.filter_content=JSON.stringify(o.filter_content),t.price=t.priceTemp,this.shencePoint("click_filter_goods",o),this.eventPoint("click_filter_goods",o),document.body.classList.remove("overflow-hidden")}},cancelSelect:function(t){var o=this;t&&t.currentTarget.dataset.type,0<o.selectData.length&&o.selectData.map(function(t,i){t.filter_data.map(function(t,e){o.$set(o.selectData[i].filter_data[e],"isactive",!1)})}),d.propKeyword={},l={},o.shaixuanLabelLength=0,o.priceSelectIndex="",o.firstPrice="",o.lastPrice="",o.priceTemp="",o.price="",o.$set(o.listQuery,"page",1),o.$set(o.listQuery,"prop_str",""),o.$set(o.listQuery,"price_range",""),o.getProductData()},changeSort:function(t){this.sortItem=t,this.isFull=!1,this.$set(this.listQuery,"page",1),this.$set(this.listQuery,"tag_id",t.id);var e=document.getElementById("tag-"+(t.index-1)),i=0;e&&(i=e.offsetLeft),document.getElementById("act-classification").scrollLeft=i,this.getProductData()},getProductData:function(){var i=this,o=Object.assign({},i.listQuery);o.activity_id=i.activityId,i.isLoad=!1,axios.get(a+"/api/activity/activity_detail_product_list",{params:o}).then(function(t){var e=t.data;"1"===e.code&&(1==o.page?(i.total=e.data.onsale_count,i.sortData=e.data.tag_list,i.sortData[0]="全部",i.productData=e.data.product_list,i.$nextTick(function(){i.getTabHeight()})):i.productData.push.apply(i.productData,e.data.product_list),0==e.data.has_next_page&&(i.isFull=!0),i.isLoad=!0)})},goToDetail:function(t,e){if(1==t.product_status){var i={pid:t.product_id,pic:t.main_pic,sk:"7-"+this.activityId};this.sk&&(i.sk=this.sk);var o={page_id:10049,channel_id:1,event_type:"click",activity_id:this.activityId,activity_name:document.title,goods_id:t.product_id,goods_name:t.product_name,goods_devices_id:t.imei,goods_price:t.price,goods_origin_price:t.ori_price,is_promotion:!1,click_title:this.sortItem.index+1+"~"+this.sortItem.name,click_index:Number(e)+1},a={event_type:"click",activity_id:this.activityId,activity_name:document.title,goods_id:t.product_id,goods_name:t.product_name,is_promotion:!1,operation_index:Number(e)+1,business_type:5};window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.gotoPage?(this.eventPoint("click_enter_goods_details",o),this.shencePoint("click_enter_goods_details",a),window.webkit.messageHandlers.gotoPage.postMessage(i)):window.control&&window.control.gotoPage?(this.eventPoint("click_enter_goods_details",o),this.shencePoint("click_enter_goods_details",a),window.control.gotoPage(JSON.stringify(i))):"miniprogram"===window.__wxjs_environment?wx.miniProgram.navigateTo({url:"../commodity-detail/commodity-detail?productId="+i.pid+"&sk="+i.sk}):Modal({title:"提示",content:"请下载找靓机app",cancelButton:!1,confirmText:"知道了"})}},gotoAct:function(t,e){var i={page_id:10049,theme__id:t.id,theme__name:t.name,activity_id:this.activityId,operation_index:e+1,event_type:"click"};this.eventPoint("click_activity_subject_recommend",i);var o="https://frontstatic.zhaoliangji.com/shop/act/activity/activity.html?activity_id="+t.id;window.location.href="zljgo://native_api?type=1&content="+encodeURIComponent(o)},gotoPart:function(t,e){var i={type:2,pid:t.product_id,pic:t.main_pic},o={page_id:10049,pat_sku_id:t.product_id,operation_index:e+1,pat_sku_name:t.product_name,event_type:"click"},a={activity_id:this.activity_id,activity_name:document.title,goods_id:t.product_id,goods_name:t.product_name,is_promotion:0,business_type:"1",event_type:"click"};window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.gotoPage?(this.shencePoint("click_enter_goods_details",a),this.eventPoint("click_activity_accessories",o),window.webkit.messageHandlers.gotoPage.postMessage(i)):window.control&&window.control.gotoPage?(this.shencePoint("click_enter_goods_details",a),this.eventPoint("click_activity_accessories",o),window.control.gotoPage(JSON.stringify(i))):Modal({title:"提示",content:"请下载找靓机app",cancelButton:!1,confirmText:"知道了"})},gotoPartList:function(){var t={activity_id:this.activity_id,activity_name:document.title,operation_module:"查看更多",operation_area:"10049.1",event_type:"click"};this.shencePoint("click_app",t),window.location.href="zljgo://native_api?type=14&content="+encodeURIComponent('{"categoryId":"19"}')},loadMore:function(){var t={page_id:10049,activity_id:this.activityId,activity_name:document.title,event_type:"click"};this.eventPoint("click_activity_show_more",t),this.listQuery.page=this.listQuery.page+1,this.getProductData()},tabControlHandle:function(){var e=this;window.onscroll=function(){var t=document.documentElement.scrollTop||document.body.scrollTop;t>=document.getElementById("tab-wrapper").offsetTop+188?e.isFixed=!0:e.isFixed=!1,e.isHideTop=!(200<t)}},openCustomerService:function(){window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.goContactIM?window.webkit.messageHandlers.goContactIM.postMessage({}):window.control&&window.control.goContactIM?window.control.goContactIM():window.open("https://zhaoliangji.qiyukf.com/client?k=2ccdb2756aad2cafdc96c1351b4e71ec&wp=1","service"),this.eventPoint("click_online_customer_service",{page_id:10049,activity_id:this.activityId,activity_name:document.title,event_type:"click"}),this.shencePoint("click_online_customer_service",{activity_id:this.activityId,activity_name:document.title,event_type:"click"})},gotoTop:function(){window.scroll(0,0)},getQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),i=window.location.search.slice(1).match(e);return null!=i?unescape(i[2]):null},eventPoint:function(t,e){this.gid&&(e.group_id=this.gid),ta.track(t,e)},shencePoint:function(t,e){this.gid&&(e.group_id=[this.gid]),console.log(sensors,"神策sdk"),sensors.track(t,e)},openBodyScroll:function(){window.lockMaskScrollTop=document.scrollingElement.scrollTop||document.body.scrollTop,document.body.classList.add("overflow-hidden"),document.body.style.top=-window.lockMaskScrollTop+"px"},closeBodyScroll:function(){document.body.classList.contains("overflow-hidden")&&(document.body.classList.remove("overflow-hidden"),document.scrollingElement.scrollTop=window.lockMaskScrollTop)}}})}();